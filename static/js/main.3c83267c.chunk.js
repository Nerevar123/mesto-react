(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,a,t){e.exports=t(19)},18:function(e,a,t){},19:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(7),o=t.n(c),l=(t(18),t(11)),i=t(1),s=t(8),m=t.n(s);var d=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:m.a,alt:"Mesto \u043b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"}))},u=r.a.createContext();var _=function(e){var a=r.a.useContext(u),t=e.card.owner._id===a._id,n=e.card.likes.some((function(e){return e._id===a._id})),c="place__like-btn button ".concat(n?"place__like-btn_active":"");return r.a.createElement("li",{className:"place"},r.a.createElement("div",{className:"place__img-wrapper",onClick:function(){e.onCardClick(e.card)}},r.a.createElement("img",{src:e.card.link,alt:e.card.name,className:"place__image"})),r.a.createElement("div",{className:"place__header"},r.a.createElement("h3",{className:"place__title"},e.card.name),r.a.createElement("div",{className:"place__like"},r.a.createElement("button",{className:c,type:"button",onClick:function(){e.onCardLike(e.card)}}),r.a.createElement("span",{className:"place__like-count"},e.card.likes.length))),r.a.createElement("button",{className:"place__delete-btn button",type:"button",style:t?{}:{display:"none"},onClick:function(){e.onDeleteClick(e.card)}}))};var p=function(e){var a=r.a.useContext(u);return 0===e.cards.length?r.a.createElement("section",{className:"profile"},r.a.createElement("h1",{className:"profile__loading"},"Loading...")):r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__avatar-box"},r.a.createElement("img",{src:a.avatar,alt:"\u0424\u043e\u0442\u043e \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__avatar button"}),r.a.createElement("button",{className:"profile__avatar-btn button",type:"button",onClick:e.onEditAvatar})),r.a.createElement("div",{className:"profile__title"},r.a.createElement("div",{className:"profile__heading"},r.a.createElement("h1",{className:"profile__name"},a.name),r.a.createElement("button",{className:"profile__edit-btn button",type:"button",onClick:e.onEditProfile})),r.a.createElement("p",{className:"profile__desc"},a.about)),r.a.createElement("button",{className:"profile__add-btn button",type:"button",onClick:e.onAddPlace})),r.a.createElement("section",{className:"places"},r.a.createElement("ul",{className:"places__list"},e.cards.map((function(a){return r.a.createElement(_,{card:a,key:a._id,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onDeleteClick:e.onDeleteClick})})))))};var h=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},f=t(2),v=t(12);var E=function(e){var a=e.children,t=Object(v.a)(e,["children"]);return r.a.useEffect((function(){function e(e){"Escape"===e.key&&a.props.onClose()}function t(e){e.target.classList.contains("modal")&&a.props.onClose()}return document.addEventListener("mousedown",t),document.addEventListener("keydown",e),function(){document.removeEventListener("mousedown",t),document.removeEventListener("keydown",e)}}),[a]),r.a.createElement(r.a.Fragment,null,r.a.cloneElement(a,Object(f.a)({},t)))};var b=function(e){return r.a.createElement("section",{className:"modal modal_type_lightbox ".concat(e.card.link?"modal_opened":"")},r.a.createElement("div",{className:"modal__lightbox"},r.a.createElement("figure",{className:"modal__figure"},r.a.createElement("img",{src:e.card.link,alt:e.card.link,className:"modal__image"}),r.a.createElement("figcaption",{className:"modal__caption"},e.card.name)),r.a.createElement("button",{className:"modal__close-btn button",type:"button",onClick:e.onClose})))};var k=function(e){var a=e.title,t=e.name,n=e.buttonText,c=void 0===n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":n,o=e.isOpen,l=e.onClose,i=e.onSubmit,s=e.isSaving,m=e.children,d=e.isDisabled,u=void 0!==d&&d;return r.a.createElement("section",{className:"modal modal_type_".concat(t," ").concat(o?"modal_opened":"")},r.a.createElement("div",{className:"modal__container"},r.a.createElement("h3",{className:"modal__title"},a),r.a.createElement("form",{className:"modal__form",name:t,method:"GET",action:"#",noValidate:!0,onSubmit:i},m,r.a.createElement("button",{className:"modal__save-btn button ".concat(u&&"modal__save-btn_disabled"),type:"submit",disabled:u},s?"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...":c)),r.a.createElement("button",{className:"modal__close-btn button",type:"button",onClick:l})))};var g=function(e){return r.a.createElement(k,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"confirm",buttonText:"\u0414\u0430",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onConfirm()},isSaving:e.isSaving})},C=t(4);var N=function(){var e=r.a.useState({}),a=Object(i.a)(e,2),t=a[0],n=a[1],c=r.a.useState({}),o=Object(i.a)(c,2),l=o[0],s=o[1],m=r.a.useState(!1),d=Object(i.a)(m,2),u=d[0],_=d[1],p=r.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n(e),s(a),_(t)}),[n,s,_]);return{values:t,handleChange:function(e){var a=e.target,r=a.value,c=a.name;n(Object(f.a)(Object(f.a)({},t),{},Object(C.a)({},c,r))),s(Object(f.a)(Object(f.a)({},l),{},Object(C.a)({},c,a.validationMessage))),_(a.closest("form").checkValidity())},errors:l,isValid:u,setIsValid:_,resetForm:p}};var y=function(e){var a=e.isOpen,t=e.onClose,n=e.onUpdateUser,c=e.isSaving,o=N(),l=o.values,i=o.handleChange,s=o.errors,m=o.isValid,d=o.setIsValid,_=o.resetForm,p=r.a.useContext(u);return r.a.useEffect((function(){p&&(_({nickname:p.name,description:p.about}),d(!0))}),[p,_,d]),r.a.createElement(k,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"title",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:a,onClose:t,onSubmit:function(e){e.preventDefault(),n({name:l.nickname||"",about:l.description||""})},isSaving:c,isDisabled:!m,children:r.a.createElement("fieldset",{className:"modal__fields"},r.a.createElement("label",{className:"modal__field"},r.a.createElement("input",{type:"text",className:"modal__input ".concat(s.nickname&&"modal__input_type_error"),name:"nickname",id:"nickname-input",required:!0,minLength:"2",maxLength:"40",pattern:"[a-zA-Z\u0430-\u044f\u0410-\u042f -]{1,}",value:l.nickname||"",onChange:i}),r.a.createElement("span",{className:"modal__placeholder ".concat(l.nickname&&"modal__placeholder_is-fixed"),id:"nickname-input-placeholder"},"\u0418\u043c\u044f"),r.a.createElement("span",{id:"nickname-input-error",className:"modal__input-error ".concat(s.nickname&&"modal__input-error_active")},s.nickname||"")),r.a.createElement("label",{className:"modal__field"},r.a.createElement("input",{type:"text",className:"modal__input ".concat(s.description&&"modal__input_type_error"),name:"description",id:"description-input",required:!0,minLength:"2",maxLength:"200",value:l.description||"",onChange:i}),r.a.createElement("span",{className:"modal__placeholder ".concat(l.description&&"modal__placeholder_is-fixed"),id:"description-input-placeholder"},"\u041e \u0441\u0435\u0431\u0435"),r.a.createElement("span",{id:"description-input-error",className:"modal__input-error ".concat(s.description&&"modal__input-error_active")},s.description||"")))})};var O=function(e){var a=e.isOpen,t=e.onClose,n=e.onUpdateAvatar,c=e.isSaving,o=N(),l=o.values,i=o.handleChange,s=o.errors,m=o.isValid,d=o.resetForm;return r.a.useEffect((function(){d()}),[a,d]),r.a.createElement(k,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",buttonText:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c",isOpen:a,onClose:t,onSubmit:function(e){e.preventDefault(),n({avatar:l.avatar||""})},isSaving:c,isDisabled:!m,children:r.a.createElement("label",{className:"modal__field"},r.a.createElement("input",{type:"url",className:"modal__input ".concat(s.avatar&&"modal__input_type_error"),name:"avatar",id:"avatar-input",required:!0,value:l.avatar||"",onChange:i}),r.a.createElement("span",{className:"modal__placeholder ".concat(l.avatar&&"modal__placeholder_is-fixed"),id:"avatar-input-placeholder"},"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440"),r.a.createElement("span",{id:"avatar-input-error",className:"modal__input-error ".concat(s.avatar&&"modal__input-error_active")},s.avatar||""))})};var S=function(e){var a=e.isOpen,t=e.onClose,n=e.onAddPlace,c=e.isSaving,o=N(),l=o.values,i=o.handleChange,s=o.errors,m=o.isValid,d=o.resetForm;return r.a.useEffect((function(){d()}),[a,d]),r.a.createElement(k,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"place",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:a,onClose:t,onSubmit:function(e){e.preventDefault(),n({name:l.name||"",link:l.link||""})},isSaving:c,isDisabled:!m,children:r.a.createElement("fieldset",{className:"modal__fields"},r.a.createElement("label",{className:"modal__field"},r.a.createElement("input",{type:"text",className:"modal__input ".concat(s.name&&"modal__input_type_error"),name:"name",id:"place-input",required:!0,minLength:"2",maxLength:"30",value:l.name||"",onChange:i}),r.a.createElement("span",{className:"modal__placeholder ".concat(l.name&&"modal__placeholder_is-fixed"),id:"place-input-placeholder"},"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),r.a.createElement("span",{id:"name-input-error",className:"modal__input-error ".concat(s.name&&"modal__input-error_active")},s.name||"")),r.a.createElement("label",{className:"modal__field"},r.a.createElement("input",{type:"url",className:"modal__input ".concat(s.link&&"modal__input_type_error"),name:"link",id:"link-input",required:!0,value:l.link||"",onChange:i}),r.a.createElement("span",{className:"modal__placeholder ".concat(l.link&&"modal__placeholder_is-fixed"),id:"link-input-placeholder"},"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"),r.a.createElement("span",{id:"link-input-error",className:"modal__input-error ".concat(s.link&&"modal__input-error_active")},s.link||"")))})},j=t(9),x=t(10),U=new(function(){function e(a){var t=a.baseUrl,n=a.headers;Object(j.a)(this,e),this._baseUrl=t,this._headers=n}return Object(x.a)(e,[{key:"_checkError",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkError)}},{key:"getInitCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkError)}},{key:"patchUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkError)}},{key:"addCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then(this._checkError)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkError)}},{key:"changeLikeCardStatus",value:function(e,a){return a?fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkError):fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkError)}},{key:"patchAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkError)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-15",headers:{authorization:"793e9e42-5ad3-4803-88e8-acbb4feac8c0","Content-Type":"application/json"}});var L=function(){var e=r.a.useState(),a=Object(i.a)(e,2),t=a[0],n=a[1],c=r.a.useState([]),o=Object(i.a)(c,2),s=o[0],m=o[1],_=r.a.useState(!1),f=Object(i.a)(_,2),v=f[0],k=f[1],C=r.a.useState(!1),N=Object(i.a)(C,2),j=N[0],x=N[1],L=r.a.useState(!1),w=Object(i.a)(L,2),D=w[0],A=w[1],P=r.a.useState(!1),T=Object(i.a)(P,2),I=T[0],V=T[1],q=r.a.useState({}),F=Object(i.a)(q,2),J=F[0],M=F[1],z=r.a.useState({}),B=Object(i.a)(z,2),H=B[0],W=B[1],G=r.a.useState(!1),R=Object(i.a)(G,2),Z=R[0],$=R[1];function K(){k(!1),x(!1),A(!1),V(!1),M({}),W({}),$(!1)}return r.a.useEffect((function(){Promise.all([U.getInitCards(),U.getUserInfo()]).then((function(e){var a=Object(i.a)(e,2),t=a[0],r=a[1];n(r),m(t)})).catch((function(e){return console.log(e)}))}),[]),r.a.createElement("div",{className:"page__content"},r.a.createElement(u.Provider,{value:t},r.a.createElement(d,null),r.a.createElement(p,{onEditProfile:function(){k(!0)},onAddPlace:function(){x(!0)},onEditAvatar:function(){A(!0)},onCardClick:function(e){M(e)},cards:s,onCardLike:function(e){var a=e.likes.some((function(e){return e._id===t._id}));U.changeLikeCardStatus(e._id,!a).then((function(a){var t=s.map((function(t){return t._id===e._id?a:t}));m(t)})).catch((function(e){return console.log(e)}))},onDeleteClick:function(e){V(!0),W(e)}}),r.a.createElement(h,null),v?r.a.createElement(E,null,r.a.createElement(y,{isOpen:v,onClose:K,onUpdateUser:function(e){$(!0),U.patchUserInfo(e).then((function(e){return n(e)})).catch((function(e){return console.log(e)})).finally((function(){return K()}))},isSaving:Z})):"",j?r.a.createElement(E,null,r.a.createElement(S,{isOpen:j,onClose:K,onAddPlace:function(e){$(!0),U.addCard(e).then((function(e){return m([e].concat(Object(l.a)(s)))})).catch((function(e){return console.log(e)})).finally((function(){return K()}))},isSaving:Z})):"",D?r.a.createElement(E,null,r.a.createElement(O,{isOpen:D,onClose:K,onUpdateAvatar:function(e){$(!0),U.patchAvatar(e).then((function(e){return n(e)})).catch((function(e){return console.log(e)})).finally((function(){return K()}))},isSaving:Z})):"",J.link?r.a.createElement(E,null,r.a.createElement(b,{card:J,onClose:K})):"",I?r.a.createElement(E,null,r.a.createElement(g,{isOpen:I,onClose:K,onConfirm:function(){$(!0),U.deleteCard(H._id).then((function(){var e=s.filter((function(e){return e._id!==H._id}));m(e)})).catch((function(e){return console.log(e)})).finally((function(){return K()}))},isSaving:Z})):""))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,a,t){e.exports=t.p+"static/media/header-logo.855a8c98.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.3c83267c.chunk.js.map